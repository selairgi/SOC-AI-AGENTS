# üõ°Ô∏è SOC AI Agents - Enhanced Security System

## Overview

A comprehensive Security Operations Center (SOC) system designed to monitor, detect, and respond to security threats in AI agent environments. This enhanced version features a modern web interface, real-time monitoring dashboard, and advanced threat detection capabilities.

## ‚ú® Key Features

### üîí Security Monitoring
- **Real-time Threat Detection**: Continuous monitoring of AI agent interactions
- **Advanced Pattern Recognition**: Detects prompt injection, data exfiltration, system manipulation, and more
- **Automated Response**: Immediate threat blocking and user suspension
- **Multi-layered Security**: Rules engine, SOC analyst, and remediator working together

### üåê Modern Web Interface
- **Enhanced Chat Interface**: Beautiful, responsive design with real-time security monitoring
- **SOC Dashboard**: Comprehensive security operations dashboard with metrics and charts
- **Real-time Alerts**: Live security notifications via WebSocket
- **Mobile Responsive**: Works seamlessly on desktop and mobile devices

### üìä Advanced Analytics
- **Threat Intelligence**: Detailed analysis of attack patterns and threat types
- **Security Metrics**: Real-time statistics on alerts, blocked threats, and system status
- **Visual Charts**: Interactive charts showing threat distribution and trends
- **Historical Data**: Track security events over time

## üöÄ Quick Start

### Prerequisites
- Python 3.7 or higher
- pip (Python package manager)

### Installation

1. **Clone or download the project**
   ```bash
   git clone <repository-url>
   cd soc-ai-agents
   ```

2. **Install dependencies**
   ```bash
   pip install -r requirements_web.txt
   ```

3. **Start the web application**
   ```bash
   python web_chatbot.py
   ```

4. **Access the interfaces**
   - **Chat Interface**: http://localhost:5000
   - **SOC Dashboard**: http://localhost:5000/dashboard

### Alternative: Use Startup Scripts

**Windows:**
```bash
start_web_chatbot.bat
```

**Linux/Mac:**
```bash
./start_web_chatbot.sh
```

## üèóÔ∏è System Architecture

### Core Components

1. **Security Rules Engine** (`security_rules.py`)
   - Defines and manages security rules
   - Pattern matching for threat detection
   - Configurable rule sets for different agent types

2. **SOC Analyst** (`soc_analyst.py`)
   - Analyzes security alerts
   - Creates remediation playbooks
   - Determines appropriate response actions

3. **Remediator** (`remediator.py`)
   - Executes security responses
   - Blocks malicious IPs and users
   - Implements automated countermeasures

4. **Message Bus** (`message_bus.py`)
   - Handles communication between components
   - Manages alert distribution
   - Ensures reliable message delivery

5. **Web Interface** (`web_chatbot.py`)
   - Flask-based web application
   - Real-time WebSocket communication
   - RESTful API endpoints

### Data Models

- **LogEntry**: Represents system logs and user interactions
- **Alert**: Security alerts generated by the rules engine
- **Playbook**: Remediation instructions created by SOC analyst
- **AgentInfo**: Information about monitored AI agents

## üõ°Ô∏è Security Features

### Threat Detection

The system detects various types of security threats:

1. **Prompt Injection**
   - Basic and advanced prompt manipulation attempts
   - System instruction overrides
   - Jailbreak attempts

2. **Data Exfiltration**
   - API key extraction attempts
   - Database access attempts
   - Sensitive data requests

3. **System Manipulation**
   - Command execution attempts
   - File system access
   - System configuration changes

4. **Privacy Violations**
   - Medical data access (HIPAA compliance)
   - Financial data access
   - Personal information requests

5. **Rate Limit Abuse**
   - High-frequency request patterns
   - Automated attack attempts

6. **Malicious Input**
   - XSS attempts
   - Script injection
   - Malicious code patterns

### Automated Response

When threats are detected, the system automatically:

1. **Immediate Actions**
   - Blocks malicious IP addresses
   - Suspends user accounts
   - Isolates compromised agents

2. **Investigation**
   - Creates forensic logs
   - Initiates detailed analysis
   - Generates incident reports

3. **Notification**
   - Alerts security teams
   - Notifies compliance officers
   - Updates system administrators

## üì± Web Interface Features

### Chat Interface (`/`)
- **Modern Design**: Clean, professional interface with dark theme
- **Real-time Monitoring**: Live security analysis of all messages
- **Alert Notifications**: Instant security alerts in the interface
- **Message History**: Persistent chat history with timestamps
- **Export Functionality**: Download chat logs for analysis

### SOC Dashboard (`/dashboard`)
- **Security Metrics**: Real-time statistics and KPIs
- **Threat Intelligence**: Detailed threat analysis and trends
- **System Status**: Component health and connectivity monitoring
- **Alert Management**: View, acknowledge, and respond to alerts
- **Visual Analytics**: Interactive charts and graphs

## üîß API Endpoints

### Chat API
- `POST /api/chat` - Send chat message
- `GET /api/security/status` - Get SOC status
- `GET /api/security/alerts` - Get security alerts
- `GET /api/security/metrics` - Get security metrics

### Security API
- `POST /api/security/block` - Block specific threats
- `POST /api/security/investigate` - Start threat investigation

### WebSocket Events
- `security_alert` - Real-time security alert notifications
- `connect` - Client connection
- `disconnect` - Client disconnection

## ‚öôÔ∏è Configuration

### Environment Presets

The system supports different environment configurations:

- **Development**: Basic monitoring for development environments
- **Medical**: HIPAA-compliant monitoring for medical AI agents
- **Financial**: Enhanced monitoring for financial AI agents
- **Production**: Full security monitoring for production environments

### Security Rules

Rules can be customized in `security_rules.py`:

```python
SecurityRule(
    rule_id="CUSTOM_001",
    name="Custom Threat Detection",
    description="Detects custom threat patterns",
    threat_type=ThreatType.MALICIOUS_INPUT,
    severity="high",
    patterns=[r"custom_pattern"],
    agent_types=[AgentType.GENERAL],
    enabled=True
)
```

## üîç Monitoring and Logging

### Log Levels
- **DEBUG**: Detailed debugging information
- **INFO**: General system information
- **WARNING**: Potential security issues
- **ERROR**: System errors and failures

### Log Sources
- Web interface interactions
- Security rule evaluations
- SOC analyst decisions
- Remediation actions
- System status changes

## üö® Alert Severity Levels

- **Critical**: Immediate threat requiring urgent response
- **High**: Significant security risk requiring prompt attention
- **Medium**: Moderate security concern requiring investigation
- **Low**: Minor security issue for monitoring

## üìà Performance Metrics

The system tracks various performance indicators:

- Total security alerts generated
- Threat detection accuracy
- Response time to threats
- System uptime and availability
- User session monitoring

## üîí Security Best Practices

1. **Regular Updates**: Keep security rules updated with latest threat patterns
2. **Monitoring**: Continuously monitor system logs and alerts
3. **Access Control**: Implement proper authentication and authorization
4. **Data Protection**: Encrypt sensitive data and logs
5. **Incident Response**: Have clear procedures for handling security incidents

## üõ†Ô∏è Development

### Adding New Security Rules

1. Define the rule in `security_rules.py`
2. Add appropriate threat type if needed
3. Test the rule with sample data
4. Deploy and monitor effectiveness

### Customizing the Web Interface

1. Modify templates in the `templates/` directory
2. Update CSS styles for custom themes
3. Add new API endpoints as needed
4. Implement additional WebSocket events

### Extending Remediation Actions

1. Add new action handlers in `remediator.py`
2. Update playbook creation in `soc_analyst.py`
3. Test with various threat scenarios
4. Document new capabilities

## üìö Documentation

- **API Documentation**: Available at `/api/docs` (if implemented)
- **Security Rules**: Documented in `security_rules.py`
- **Configuration**: See `config.py` and `environment_config.py`
- **Testing**: See `TESTING_GUIDE.md`

## ü§ù Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Add tests for new functionality
5. Submit a pull request

## üìÑ License

This project is licensed under the MIT License - see the LICENSE file for details.

## üÜò Support

For support and questions:
- Create an issue in the repository
- Check the documentation
- Review the testing guide

## üîÑ Changelog

### Version 2.0 (Current)
- Enhanced web interface with modern design
- Comprehensive SOC dashboard
- Real-time threat monitoring
- Improved alert detection
- Better remediation capabilities
- Mobile-responsive design
- Advanced analytics and reporting

### Version 1.0
- Basic SOC monitoring
- Simple web interface
- Core security rules
- Basic remediation

---

**üõ°Ô∏è SOC AI Agents - Protecting AI systems with intelligent security monitoring**

